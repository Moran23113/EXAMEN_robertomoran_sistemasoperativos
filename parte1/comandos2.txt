Ejercicio 1.2: Volúmenes y Persistencia (PostgreSQL)

1) Crear volumen llamado datos-examen
Comando:
  docker volume create datos-examen
SALIDA:
datos-examen

2) Ejecutar contenedor postgres:15-alpine con volumen y variables
- Nombre: db-examen
- Volumen: datos-examen montado en /var/lib/postgresql/data
- Variables: POSTGRES_PASSWORD=examen123, POSTGRES_DB=testdb
- Puerto: 5432:5432
Comando:
  docker run -d --name db-examen -e POSTGRES_PASSWORD=examen123 -e POSTGRES_DB=testdb -v datos-examen:/var/lib/postgresql/data -p 5432:5432 postgres:15-alpine
SALIDA:
91d0ed4ea45aeac145083529c206d6d521e97be2026c32766263e57b2e3247c1

3) Verificar que inició correctamente
Comandos:
  docker ps --filter name=db-examen
  docker logs db-examen --tail 50
SALIDA:
CONTAINER ID   IMAGE                COMMAND                  CREATED         STATUS         PORTS                                         NAMES
91d0ed4ea45a   postgres:15-alpine   "docker-entrypoint.s…"   8 minutes ago   Up 8 minutes   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp   db-examen

4) Crear datos para verificar persistencia
Comandos:
  docker exec -e PGPASSWORD=examen123 db-examen psql -U postgres -d testdb -c "CREATE TABLE IF NOT EXISTS demo (id SERIAL PRIMARY KEY, nombre TEXT);"
  docker exec -e PGPASSWORD=examen123 db-examen psql -U postgres -d testdb -c "INSERT INTO demo (nombre) VALUES ('persistencia');"
  docker exec -e PGPASSWORD=examen123 db-examen psql -U postgres -d testdb -c "SELECT COUNT(*) AS total FROM demo;"
SALIDA:
CREATE TABLE
INSERT 0 1
 total 
-------
     1
(1 row)

5) Detener y eliminar el contenedor, recrearlo y validar persistencia
Comandos:
  docker stop db-examen
  docker rm db-examen
  docker run -d --name db-examen -e POSTGRES_PASSWORD=examen123 -e POSTGRES_DB=testdb -v datos-examen:/var/lib/postgresql/data -p 5432:5432 postgres:15-alpine
  docker exec -e PGPASSWORD=examen123 db-examen psql -U postgres -d testdb -c "SELECT COUNT(*) AS total FROM demo;"
SALIDA:
 total 
-------
     1
(1 row)

6) Comandos de estado generales
Comandos:
  docker ps -a
  docker volume ls
SALIDA:
CONTAINER ID   IMAGE                             COMMAND                  CREATED         STATUS                      PORTS                                             NAMES
50091c1a2248   postgres:15-alpine                "docker-entrypoint.s…"   2 minutes ago   Up 2 minutes                0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp       db-examen
db45834b542a   ejercicio15-frontend:latest       "/docker-entrypoint.…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-frontend-1
12825ecb54bb   adminer:latest                    "entrypoint.sh docke…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-adminer-1
f7beb31a92f9   ejercicio15-backend:latest        "docker-entrypoint.s…"   3 hours ago     Exited (1) 3 hours ago                                                        ejercicio15-api-1
029191e25c58   postgres:15                       "docker-entrypoint.s…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-db-1
ecd846f22b9b   redis:alpine                      "docker-entrypoint.s…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-redis-1
583848ed1c7d   prom/prometheus:latest            "/bin/prometheus --c…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-prometheus-1
6ed80294ecc5   grafana/grafana:latest            "/run.sh"                3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-grafana-1
aa5095bde7b0   gcr.io/cadvisor/cadvisor:latest   "/usr/bin/cadvisor -…"   3 hours ago     Exited (0) 3 hours ago                                                        ejercicio15-cadvisor-1
b0be7d83ecc0   prom/node-exporter:latest         "/bin/node_exporter"     3 hours ago     Exited (2) 3 hours ago                                                        ejercicio15-node-exporter-1
21d32d8da73a   22621ff1635a                      "docker-entrypoint.s…"   3 hours ago     Exited (1) 3 hours ago                                                        ejercicio15-backend-1
d8c8c35e0c6d   nginx:alpine                      "/docker-entrypoint.…"   3 hours ago     Exited (0) 3 hours ago                                                        reverse-proxy
473b5af4d231   ejercicio14-frontend              "/docker-entrypoint.…"   3 hours ago     Exited (0) 3 hours ago                                                        frontend
d7a0c7344435   ejercicio14-api-productos         "docker-entrypoint.s…"   3 hours ago     Exited (137) 3 hours ago                                                      productos-service
766cce4beeab   ejercicio14-api-usuarios          "docker-entrypoint.s…"   3 hours ago     Exited (137) 3 hours ago                                                      usuarios-service
b4e7416e4fa7   ejercicio13-api                   "docker-entrypoint.s…"   3 hours ago     Exited (1) 3 hours ago                                                        api-prod
f6f97feed1ff   ejercicio12-api                   "docker-entrypoint.s…"   3 hours ago     Exited (1) 3 hours ago                                                        node-api
65fe4bcbf311   mongo-express                     "/sbin/tini -- /dock…"   3 hours ago     Up 35 minutes               0.0.0.0:8081->8081/tcp, [::]:8081->8081/tcp       mongo-express
3745cb349446   mongo:5.0                         "docker-entrypoint.s…"   3 hours ago     Up 35 minutes               0.0.0.0:27017->27017/tcp, [::]:27017->27017/tcp   mongo-db
1041f425522f   phpmyadmin:latest                 "/docker-entrypoint.…"   2 days ago      Exited (0) 46 hours ago                                                       phpmyadmin
6967a971255c   ejercicio11-web                   "docker-php-entrypoi…"   2 days ago      Exited (0) 46 hours ago                                                       apache-php
ab60ed0042d7   mysql:8.0                         "docker-entrypoint.s…"   2 days ago      Exited (137) 46 hours ago                                                     mysql-db
96c88baea15b   fullstack-app:v2                  "/docker-entrypoint.…"   4 days ago      Exited (0) 2 days ago                                                         fullstack
afc4629473d4   mi-app-env:v2                     "docker-entrypoint.s…"   4 days ago      Exited (137) 4 days ago                                                       app-env-dev
6998815f4917   mi-app-env:v2                     "docker-entrypoint.s…"   4 days ago      Exited (137) 4 days ago                                                       app-env
9d5d84dd0b86   go-app-optimizada:latest          "./server"               5 days ago      Exited (2) 4 days ago                                                         goapp
8b09e4bf6fcd   go-app-optimizada:latest          "./server"               5 days ago      Exited (2) 5 days ago                                                         youthful_dirac
944ebd350e0e   mi-api-node                       "docker-entrypoint.s…"   5 days ago      Exited (137) 5 days ago                                                       api-container
bb26219cf6d0   mi-app-python                     "python app.py"          5 days ago      Exited (137) 5 days ago                                                       python-contador
063becbe59ff   ubuntu:latest                     "bash"                   6 days ago      Exited (137) 5 days ago                                                       mi-ubuntu
c028dc482890   hello-world                       "/hello"                 6 days ago      Exited (0) 6 days ago                                                         kind_euler
DRIVER    VOLUME NAME
local     48085a2e7430190e0d78f272181c38fe8004e4bc39aaf474f781815e927c563f
local     be8098cffd7c40cee2797d6acf3c07e0fb5f9f43898fa78182285ea75189d16e
local     cc658667819740e1dac2dfb14506abd21efedc2a4ae4065136a51ebc614f558d
local     datos-examen
local     datos-mysql
local     ejercicio11_db-data
local     ejercicio12_mongo-data
local     ejercicio15_db-data
local     ejercicio15_postgres-data
local     ejercicio15_redis-data
local     fb83ed8e8e0684d66bac78a3b7068a7f8d2a3424f7b4e4de1458d58ffdd945ac